<div class="container-fluid">
  <div class="row">
    <div class="col-sm-12">
      <div class="card tab2-card">
        <div class="card-header">
          <h5></h5>
        </div>
        <div class="card-body tab2-card">
          <div class="container-fluid">
            <div class="row">
              <div class="container-fluid">
                <div class="row">
                  <div class="container-fluid">
                    <div class="row">
                      <!-- <div class="col-md-2 p-0">
                                            <app-menu></app-menu>
                                          </div> -->
                      <div class="col-xs-6 col-md-12  col-xl-12 p-0">

                        <div class="text-center">
                          <div class="row d-flex justify-content-center">
                            <div class="col-lg-8">
                              <div id="body">
                                <h1 class="fw-bold mb-5">Carga Masiva de Datos</h1>
                                <div class="input-group" id="file">
                                  <input accept=".xlsx, .xls" (change)="onFileChange($event)" type="file"
                                    class="form-control" id="inputGroupFile04" aria-describedby="inputGroupFileAddon04"
                                    aria-label="Upload">
                                  <button class="btn btn-outline-primary" type="button" id="inputGroupFileAddon04"
                                    (click)="convertToJSON()" *ngIf="hasExpectedStructure">Guardar</button>
                                </div>
                                <h4 style="color: red; padding: 10px;">{{mensaje}}</h4>
                                <h3>{{progreso}}</h3>
                              </div>
                              <h1 *ngIf="registrado">Productos registrados</h1>
                              <table *ngIf="registrado" class="table table-hover">
                                <thead>
                                  <tr>
                                    <th>Estado</th>
                                    <th>Nombre</th>
                                    <th>CÃ©dula</th>
                                    <th>Correo</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let producto of productos">
                                    <td [style.color]=" estado ? 'green' : 'red'">{{ estado ? 'Registrado' : 'No
                                      Registrado' }}</td>
                                    <td>{{ producto.nombres | uppercase }}</td>
                                    <td>{{ producto.cedula | uppercase}}</td>
                                    <td>{{ producto.correo1 | uppercase }}</td>
                                  </tr>
                                </tbody>
                              </table>

                              <h2 *ngIf="error">Productos con errores </h2>
                              <table *ngIf="error" class="table table-hover">
                                <thead>
                                  <tr>
                                    <th>Estado</th>
                                    <th>Nombre</th>
                                    <th>Cedula</th>
                                    <th>Correo</th>
                                    <th>Errores</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let producto of productosError">
                                    <td [style.color]="'red'">{{'No Registrado'}}</td>
                                    <td>{{ producto.nombres | uppercase }}</td>
                                    <td>{{ producto.cedula | uppercase}}</td>
                                    <td>{{ producto.correo1 | uppercase }}</td>
                                    <td [style.color]="'red'">{{ producto.mensaje | uppercase }}</td>

                                  </tr>
                                </tbody>
                              </table>
                              <!-- <button *ngIf="!registrado" class="btn btn-success" (click)="downloadExcel()">
                                                    <i class="icofont icofont-file-excel"></i>
                                                    Descargar Plantilla
                                                  </button> -->
                              <button *ngIf="!registrado" class="btn btn-success" (click)="downloadExcel()">
                                <i class="icofont icofont-file-excel"></i>
                                Descargar Plantilla
                              </button>
                              <button *ngIf="error" class="btn btn-primary" (click)="convertToExcel()">
                                <i class="icofont icofont-file-excel"></i>
                                Descargar errores
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>